name: decoder/suricata-http/0

sources:
  - decoder/suricata/0

metadata:
  module: suricata
  compatibility: <= v7
  author:
    name: Wazuh Inc, info@wazuh.com
    date: Nov 18 2022
  references:
    - https://suricata.readthedocs.io/en/suricata-6.0.8/output/eve/eve-json-format.html?highlight=eve%20format
  title: Suricata decoder
  description: Decoder for Suricata solution

definitions:
  is_http_success: +s_eq/~json.event_type/http AND +t_is_num/~json.http.status AND +i_lt/~json.http.status/400
  is_http_failure: +s_eq/~json.event_type/http AND +t_is_num/~json.http.status AND +i_ge/~json.http.status/400

check:
  - ~json.event_type: +s_eq/http

normalize:
  - check: $is_http_success
    map:
      - event.outcome: success

  - check: $is_http_failure
    map:
      - event.outcome: failure
